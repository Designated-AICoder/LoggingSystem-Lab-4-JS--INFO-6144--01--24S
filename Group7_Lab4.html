<!DOCTYPE html>
<html>
<head>
    <title>Lab 4</title>
    <script language="JavaScript" type="text/JavaScript">
    
    let timers = []; 

    let log = (function (outputFunc) {
        let cnt = 0; // Counter
        let cLog = []; // caller names Array
        let dtLog = []; // log date and time Array

        // Return an anonymous function
        return function(caller) {
            cnt++; 
            cLog.push(caller); 
            dtLog.push(new Date()); 

            let output = cnt + " " + cLog[cLog.length - 1] + " " + dtLog[dtLog.length - 1];

            outputFunc(output);

            // If counter exceeds 10, stop all timers
            if (cnt > 10) {
                for (let i = 0; i < timers.length; i++) {
                    clearInterval(timers[i]);
                }
		outputFunc("")
		outputFunc("Logging stopped");
            }
        }
    })(printFunc); // IIFE

    function printFunc(output) {
        document.body.innerHTML += output + "<br>";
    }

    function startMeUp() {
	// add each of the timer references to the timers array
	// as part of invoking the log function following each interval
        timers.push(setInterval(() => log('Timer1'), 1000));
        timers.push(setInterval(() => log('Timer2'), 1200));
        timers.push(setInterval(() => log('Timer3'), 1700));
    }

    </script>
</head>
<body onload="startMeUp();">

</body>
</html>
